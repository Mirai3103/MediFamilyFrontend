import{z as B,j as e,t as P,s as q,r as l,J as re,K as ie,m as le}from"./index-BW1v2Y3o.js";import{B as d,P as A,u as ce}from"./index-lZj-UG3P.js";import{A as oe}from"./arrow-left-C9GuLsQY.js";import{u as de,s as he,L as me}from"./label-C5VtnZRZ.js";import{z as N}from"./index-B3p3PcZP.js";import{D as $,a as V,b as G,c as Y,d as K,e as X,f as Z}from"./dialog-CtifNpLo.js";import{F as xe,a as b,b as v,c as C,d as w,e as D}from"./form-CBmUezT4.js";import{I}from"./input-B9pFp4AM.js";import{T as U}from"./textarea-DMIEle1g.js";import{D as pe,C as ue,R as je,B as ge}from"./RecordForm-DKCh1WY8.js";import{P as J}from"./plus-Brih1OWA.js";import{T as fe,a as Ne,b as Q,c as k,d as ye,e as T}from"./table-DjxPWTM_.js";import{c as F}from"./createLucideIcon-BIXz2lW7.js";import{S as W}from"./square-pen-BUiDCqt8.js";import{C as be,a as ve,b as Ce,c as we,d as De,e as ke}from"./card-Bb8dNGOw.js";import{B as Te}from"./badge-B4P0SrPl.js";import{D as Pe,a as Fe,b as Ie,c as Se,d as Me,e as _e,f as Re}from"./drawer-CY_oHpP7.js";import{u as Ae,c as Le,a as Oe,P as He,b as Ee}from"./index-BvPlwEJa.js";import{u as Ue}from"./index-BYx5ngvf.js";import{a as ze,g as Be}from"./file-D5Y2yJfI.js";import{X as qe}from"./index-fdDP8kav.js";import{C as $e}from"./calendar-DSwk2Pit.js";import{U as Ve,F as Ge}from"./user-BXjafA9g.js";import{U as Ye,F as _,D as Ke}from"./upload-D_Rj1oCM.js";import{T as ee}from"./trash-2-D3N7ccQE.js";import"./clsx-B-dksMZM.js";import"./popover-DmVzagL2.js";import"./en-US-5imNvEBo.js";import"./endOfMonth-DGAv_To5.js";import"./format-CR5l4UVX.js";import"./chevron-right-66CTOTse.js";import"./index-BWVphily.js";import"./index-Bb3g6j3I.js";import"./vi-vOVGMeUr.js";import"./checkbox-Do6_XIjt.js";import"./check-BMh_iTMB.js";import"./stethoscope-BzvBMdBi.js";/**
 * @license lucide-react v0.481.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Ze=F("ExternalLink",Xe);/**
 * @license lucide-react v0.481.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]],Qe=F("FilePlus",Je);/**
 * @license lucide-react v0.481.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=[["path",{d:"M21 7h-3a2 2 0 0 1-2-2V2",key:"9rb54x"}],["path",{d:"M21 6v6.5c0 .8-.7 1.5-1.5 1.5h-7c-.8 0-1.5-.7-1.5-1.5v-9c0-.8.7-1.5 1.5-1.5H17Z",key:"1059l0"}],["path",{d:"M7 8v8.8c0 .3.2.6.4.8.2.2.5.4.8.4H15",key:"16874u"}],["path",{d:"M3 12v8.8c0 .3.2.6.4.8.2.2.5.4.8.4H11",key:"k2ox98"}]],es=F("FileStack",We);/**
 * @license lucide-react v0.481.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],ts=F("Info",ss);/**
 * @license lucide-react v0.481.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],as=F("Paperclip",ns);/**
 * @license lucide-react v0.481.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],is=F("Pill",rs);function ls(){const{history:s}=B();return e.jsxs(d,{variant:"ghost",className:"mb-4",onClick:()=>s.back(),children:[e.jsx(oe,{className:"mr-2 h-4 w-4"}),"Quay lại"]})}const cs=N.object({medicationName:N.string().min(2,{message:"Tên thuốc phải có ít nhất 2 ký tự"}).max(200),dosage:N.string().min(1,{message:"Liều dùng không được để trống"}).max(100),frequency:N.string().min(1,{message:"Tần suất sử dụng không được để trống"}).max(100),durationInDays:N.number().min(1,{message:"Số ngày sử dụng phải lớn hơn hoặc bằng 1"}),startUseDate:N.date({required_error:"Vui lòng chọn ngày bắt đầu"}),instructions:N.string().max(500).optional(),notes:N.string().max(1e3).optional()});function os({open:s,onOpenChange:n,onAdd:r,existingPrescriptions:t}){const a=de({resolver:he(cs),defaultValues:{medicationName:"",dosage:"",frequency:"",durationInDays:1,startUseDate:new Date,instructions:"",notes:""}}),i=c=>{const m={id:Math.max(0,...t.map(p=>p.id))+1,...c};r(m),n(!1),a.reset(),P("Thêm thuốc thành công",{description:"Thuốc đã được thêm vào đơn thuốc"})};return e.jsxs($,{open:s,onOpenChange:n,children:[e.jsx(V,{asChild:!0,children:e.jsxs(d,{children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Thêm thuốc"]})}),e.jsxs(G,{className:"sm:max-w-[600px]",children:[e.jsxs(Y,{children:[e.jsx(K,{children:"Thêm thuốc mới"}),e.jsx(X,{children:"Điền thông tin chi tiết về thuốc được kê trong đơn."})]}),e.jsx(ds,{form:a,onSubmit:i,onCancel:()=>n(!1)})]})]})}function ds({form:s,onSubmit:n,onCancel:r}){return e.jsx(xe,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(n),className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(b,{control:s.control,name:"medicationName",render:({field:t})=>e.jsxs(v,{children:[e.jsx(C,{children:"Tên thuốc"}),e.jsx(w,{children:e.jsx(I,{placeholder:"Nhập tên thuốc",...t})}),e.jsx(D,{})]})}),e.jsx(b,{control:s.control,name:"dosage",render:({field:t})=>e.jsxs(v,{children:[e.jsx(C,{children:"Liều dùng"}),e.jsx(w,{children:e.jsx(I,{placeholder:"VD: 5mg, 10ml...",...t})}),e.jsx(D,{})]})}),e.jsx(b,{control:s.control,name:"frequency",render:({field:t})=>e.jsxs(v,{children:[e.jsx(C,{children:"Tần suất sử dụng"}),e.jsx(w,{children:e.jsx(I,{placeholder:"VD: 1 viên/ngày, 2 lần/ngày...",...t})}),e.jsx(D,{})]})}),e.jsx(b,{control:s.control,name:"durationInDays",render:({field:t})=>e.jsxs(v,{children:[e.jsx(C,{children:"Thời gian sử dụng (ngày)"}),e.jsx(w,{children:e.jsx(I,{type:"number",min:1,placeholder:"Số ngày sử dụng",...t,onChange:a=>t.onChange(parseInt(a.target.value))})}),e.jsx(D,{})]})}),e.jsx(b,{control:s.control,name:"startUseDate",render:({field:t})=>e.jsxs(v,{children:[e.jsx(C,{children:"Ngày bắt đầu"}),e.jsx(w,{children:e.jsx(pe,{date:t.value,onSelect:t.onChange})}),e.jsx(D,{})]})})]}),e.jsx(b,{control:s.control,name:"instructions",render:({field:t})=>e.jsxs(v,{children:[e.jsx(C,{children:"Hướng dẫn sử dụng"}),e.jsx(w,{children:e.jsx(U,{placeholder:"VD: Uống sau bữa ăn, uống với nhiều nước...",...t})}),e.jsx(D,{})]})}),e.jsx(b,{control:s.control,name:"notes",render:({field:t})=>e.jsxs(v,{children:[e.jsx(C,{children:"Ghi chú"}),e.jsx(w,{children:e.jsx(U,{placeholder:"Ghi chú thêm về thuốc này nếu cần",...t})}),e.jsx(D,{})]})}),e.jsxs(Z,{children:[e.jsx(d,{type:"button",variant:"outline",onClick:r,children:"Hủy"}),e.jsx(d,{type:"submit",children:"Thêm thuốc"})]})]})})}function hs({prescriptions:s,onOpenAddDialog:n}){return e.jsxs("div",{className:"bg-white p-6 rounded-lg border shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(is,{className:"h-6 w-6 text-health-blue mr-3"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Danh sách thuốc"})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.length," loại thuốc"]})]}),s.length>0?e.jsx(ms,{prescriptions:s}):e.jsx(ps,{onAddClick:n})]})}function ms({prescriptions:s}){return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(fe,{children:[e.jsx(Ne,{children:e.jsxs(Q,{children:[e.jsx(k,{children:"Tên thuốc"}),e.jsx(k,{children:"Liều dùng"}),e.jsx(k,{children:"Tần suất"}),e.jsx(k,{children:"Thời gian"}),e.jsx(k,{children:"Ngày bắt đầu"}),e.jsx(k,{children:"Hướng dẫn"}),e.jsx(k,{className:"text-right",children:"Thao tác"})]})}),e.jsx(ye,{children:s.map(n=>e.jsx(xs,{prescription:n},n.id))})]})})}function xs({prescription:s}){const n=()=>{P("Thông tin chi tiết",{description:e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Ghi chú:"})," ",s.notes||"Không có"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Hướng dẫn:"})," ",s.instructions||"Không có"]})]})})};return e.jsxs(Q,{children:[e.jsx(T,{className:"font-medium",children:s.medicationName}),e.jsx(T,{children:s.dosage}),e.jsx(T,{children:s.frequency}),e.jsxs(T,{children:[s.durationInDays," ngày"]}),e.jsx(T,{children:q(s.startUseDate).format("DD/MM/YYYY")}),e.jsx(T,{className:"max-w-[200px] truncate",children:s.instructions||"-"}),e.jsxs(T,{className:"text-right",children:[e.jsx(d,{variant:"ghost",size:"sm",className:"mr-1",children:e.jsx(W,{className:"h-4 w-4"})}),e.jsx(d,{variant:"ghost",size:"sm",onClick:n,children:e.jsx(ts,{className:"h-4 w-4"})})]})]})}function ps({onAddClick:s}){return e.jsxs("div",{className:"text-center py-12 border rounded-lg bg-gray-50",children:[e.jsx(ue,{className:"h-12 w-12 mx-auto text-gray-400 mb-3"}),e.jsx("h3",{className:"text-lg font-medium text-gray-600",children:"Chưa có thuốc nào"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Thêm thuốc vào đơn này"}),e.jsxs(d,{onClick:s,className:"",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Thêm thuốc"]})]})}var R="Collapsible",[us,mt]=Le(R),[js,L]=us(R),se=l.forwardRef((s,n)=>{const{__scopeCollapsible:r,open:t,defaultOpen:a,disabled:i,onOpenChange:c,...m}=s,[p,j]=Ae({prop:t,defaultProp:a??!1,onChange:c,caller:R});return e.jsx(js,{scope:r,disabled:i,contentId:Ue(),open:p,onOpenToggle:l.useCallback(()=>j(g=>!g),[j]),children:e.jsx(A.div,{"data-state":H(p),"data-disabled":i?"":void 0,...m,ref:n})})});se.displayName=R;var te="CollapsibleTrigger",ne=l.forwardRef((s,n)=>{const{__scopeCollapsible:r,...t}=s,a=L(te,r);return e.jsx(A.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":H(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...t,ref:n,onClick:Oe(s.onClick,a.onOpenToggle)})});ne.displayName=te;var O="CollapsibleContent",ae=l.forwardRef((s,n)=>{const{forceMount:r,...t}=s,a=L(O,s.__scopeCollapsible);return e.jsx(He,{present:r||a.open,children:({present:i})=>e.jsx(gs,{...t,ref:n,present:i})})});ae.displayName=O;var gs=l.forwardRef((s,n)=>{const{__scopeCollapsible:r,present:t,children:a,...i}=s,c=L(O,r),[m,p]=l.useState(t),j=l.useRef(null),g=ce(n,j),y=l.useRef(0),h=y.current,o=l.useRef(0),x=o.current,f=c.open||m,S=l.useRef(f),M=l.useRef(void 0);return l.useEffect(()=>{const u=requestAnimationFrame(()=>S.current=!1);return()=>cancelAnimationFrame(u)},[]),Ee(()=>{const u=j.current;if(u){M.current=M.current||{transitionDuration:u.style.transitionDuration,animationName:u.style.animationName},u.style.transitionDuration="0s",u.style.animationName="none";const E=u.getBoundingClientRect();y.current=E.height,o.current=E.width,S.current||(u.style.transitionDuration=M.current.transitionDuration,u.style.animationName=M.current.animationName),p(t)}},[c.open,t]),e.jsx(A.div,{"data-state":H(c.open),"data-disabled":c.disabled?"":void 0,id:c.contentId,hidden:!f,...i,ref:g,style:{"--radix-collapsible-content-height":h?`${h}px`:void 0,"--radix-collapsible-content-width":x?`${x}px`:void 0,...s.style},children:f&&a})});function H(s){return s?"open":"closed"}var fs=se;function Ns({...s}){return e.jsx(fs,{"data-slot":"collapsible",...s})}function ys({...s}){return e.jsx(ne,{"data-slot":"collapsible-trigger",...s})}function bs({...s}){return e.jsx(ae,{"data-slot":"collapsible-content",...s})}function vs({record:s}){var g,y;const[n,r]=l.useState(!1),[t,a]=l.useState(!1),i=s.attachments||[],c=B(),{mutate:m,isPending:p}=re({mutation:{onSuccess:h=>{P.success("Tải lên tệp thành công"),c.invalidate({})},onError:h=>{P.error("Tải lên tệp thất bại",{description:h.message})}}}),j=h=>{h.length>0&&m({data:{attachments:h},id:s.id.toString()}),a(!1)};return e.jsxs(be,{className:"mb-8",children:[e.jsx(ve,{className:"pb-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(Ce,{className:"text-2xl font-bold",children:s.title}),e.jsx(we,{children:"Thông tin chi tiết về lần khám"})]}),e.jsx(Te,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:s.diagnosis})]})}),e.jsxs(De,{className:"pt-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(Cs,{record:s}),e.jsx(ws,{record:s})]}),i&&i.length>0&&e.jsx(Ds,{attachments:i,onRemove:h=>{confirm("Bạn có chắc chắn muốn xóa tệp này không?")&&ie(s.id.toString(),{attachment:h}).then(()=>{P.success("Xóa tệp thành công"),c.invalidate({})}).catch(o=>{P.error("Xóa tệp thất bại",{description:o.message})})}})]}),e.jsxs(ke,{className:"border-t pt-4 flex justify-end",children:[e.jsxs(Pe,{open:n,onOpenChange:r,direction:"right",children:[e.jsx(Fe,{asChild:!0,children:e.jsxs(d,{variant:"outline",size:"sm",children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),"Chỉnh sửa thông tin"]})}),e.jsx(Ie,{className:"!max-w-3xl ",children:e.jsxs("div",{className:"mx-auto w-full max-w-3xl",children:[e.jsx(Se,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(Me,{className:"text-2xl font-bold text-gray-800",children:"Chỉnh sửa hồ sơ khám"}),e.jsxs(_e,{className:"text-gray-500",children:["Hồ sơ khám cho"," ",((g=s.profile)==null?void 0:g.fullName)||"bệnh nhân"]})]}),e.jsx(Re,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"icon",children:e.jsx(qe,{className:"h-5 w-5"})})})]})}),e.jsx("div",{className:"px-4 py-2",children:e.jsx(je,{type:"edit",onDone:h=>{r(!1)},recordId:s.id,profileId:((y=s.profile)==null?void 0:y.id)||s.profileId})})]})})]}),e.jsxs($,{open:t,onOpenChange:a,children:[e.jsx(V,{asChild:!0,children:e.jsxs(d,{size:"sm",className:"ml-2",disabled:p,children:[e.jsx(es,{className:"mr-2 h-4 w-4"}),"Tải lên hồ sơ"]})}),e.jsx(G,{children:e.jsx(ks,{onUpload:j,recordId:s.id,onCancel:()=>a(!1)})})]})]})]})}function Cs({record:s}){return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center text-gray-700",children:[e.jsx($e,{className:"h-5 w-5 mr-2 text-gray-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Ngày khám: "}),q(s.visitDate).format("DD/MM/YYYY")]})]}),e.jsxs("div",{className:"flex items-center text-gray-700",children:[e.jsx(ge,{className:"h-5 w-5 mr-2 text-gray-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Cơ sở y tế: "}),s.medicalFacility]})]}),e.jsxs("div",{className:"flex items-center text-gray-700",children:[e.jsx(Ve,{className:"h-5 w-5 mr-2 text-gray-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Bác sĩ: "}),s.doctorName]})]})]})}function ws({record:s}){return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start text-gray-700",children:[e.jsx(Qe,{className:"h-5 w-5 mr-2 text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Phương pháp điều trị: "}),s.treatment]})]}),s.notes&&e.jsxs("div",{className:"flex items-start text-gray-700",children:[e.jsx(Ge,{className:"h-5 w-5 mr-2 text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Ghi chú: "}),s.notes]})]})]})}function Ds({attachments:s,onRemove:n}){const[r,t]=l.useState(!1);return e.jsxs(Ns,{open:r,onOpenChange:t,className:"mt-6 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center text-gray-700",children:[e.jsx(as,{className:"h-5 w-5 mr-2 text-gray-500"}),e.jsxs("h3",{className:"font-medium",children:["Tệp đính kèm (",s.length,")"]})]}),e.jsx(ys,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"sm",children:r?"Ẩn bớt":"Xem tất cả"})})]}),e.jsx("div",{className:"mt-3 space-y-2",children:s.slice(0,2).map((a,i)=>e.jsx(z,{fileName:a,onRemove:()=>n==null?void 0:n(a)},i))}),e.jsx(bs,{children:e.jsx("div",{className:"mt-2 space-y-2",children:s.slice(2).map((a,i)=>e.jsx(z,{fileName:a,onRemove:()=>n==null?void 0:n(a)},i+2))})})]})}function z({fileName:s,onRemove:n}){const r=t=>{var i;const a=(i=t.split(".").pop())==null?void 0:i.toLowerCase();return a==="pdf"?e.jsx(_,{className:"h-4 w-4 text-red-500"}):["jpg","jpeg","png","gif"].includes(a||"")?e.jsx(_,{className:"h-4 w-4 text-blue-500"}):e.jsx(_,{className:"h-4 w-4 text-gray-500"})};return e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center",children:[r(s),e.jsx("span",{className:"ml-2 text-sm",children:s})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(d,{variant:"ghost",size:"icon",className:"h-8 w-8",asChild:!0,children:e.jsx("a",{href:ze(s),download:!0,children:e.jsx(Ke,{className:"h-4 w-4 text-gray-500"})})}),e.jsx(d,{variant:"ghost",size:"icon",className:"h-8 w-8",asChild:!0,children:e.jsx("a",{href:Be(s),target:"_blank",children:e.jsx(Ze,{className:"h-4 w-4 text-gray-500"})})}),e.jsx(d,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:n,children:e.jsx(ee,{className:"h-4 w-4 text-red-500"})})]})]})}function ks({recordId:s,onUpload:n,onCancel:r}){const[t,a]=l.useState([]),[i,c]=l.useState(!1),m=o=>{if(o.target.files){const x=Array.from(o.target.files);a(f=>[...f,...x])}},p=o=>{o.preventDefault(),c(!0)},j=()=>{c(!1)},g=o=>{if(o.preventDefault(),c(!1),o.dataTransfer.files){const x=Array.from(o.dataTransfer.files);a(f=>[...f,...x])}},y=o=>{a(x=>x.filter((f,S)=>S!==o))},h=()=>{n(t),a([])};return e.jsxs(e.Fragment,{children:[e.jsxs(Y,{children:[e.jsx(K,{children:"Tải lên hồ sơ"}),e.jsx(X,{children:"Tải lên các tệp đính kèm cho hồ sơ khám bệnh này"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx("div",{className:`border-2 border-dashed rounded-lg p-6 text-center ${i?"border-blue-500 bg-blue-50":"border-gray-300"}`,onDragOver:p,onDragLeave:j,onDrop:g,children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(Ye,{className:"h-10 w-10 text-gray-400 mb-3"}),e.jsx("p",{className:"text-sm font-medium mb-1",children:"Kéo thả tệp tại đây hoặc"}),e.jsx(me,{htmlFor:"file-upload",className:"cursor-pointer text-blue-600 hover:text-blue-800",children:"Chọn tệp"}),e.jsx(I,{id:"file-upload",type:"file",multiple:!0,className:"hidden",onChange:m}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Hỗ trợ các định dạng: PDF, JPG, PNG, DOCX"})]})}),t.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"text-sm font-medium",children:["Danh sách tệp (",t.length,")"]}),e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2",children:t.map((o,x)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(_,{className:"h-4 w-4 text-gray-500 mr-2"}),e.jsx("span",{className:"text-sm truncate max-w-[250px]",children:o.name}),e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",(o.size/1024).toFixed(1)," KB)"]})]}),e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>y(x),children:e.jsx(ee,{className:"h-4 w-4 text-red-500"})})]},x))})]})]}),e.jsxs(Z,{children:[e.jsx(d,{variant:"outline",onClick:r,children:"Hủy"}),e.jsx(d,{onClick:h,disabled:t.length===0,children:"Tải lên"})]})]})}function Ts({record:s,prescriptions:n}){const[r,t]=l.useState(!1),[a,i]=l.useState(n),c=m=>{i([...a,m])};return e.jsxs("div",{className:"container max-w-6xl mx-auto py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(ls,{}),e.jsx(Ps,{title:"Đơn thuốc",description:"Quản lý đơn thuốc cho lần khám",action:e.jsx(os,{open:r,onOpenChange:t,onAdd:c,existingPrescriptions:a})})]}),e.jsx(vs,{record:s}),e.jsx(hs,{prescriptions:a,onOpenAddDialog:()=>t(!0)})]})}function Ps({title:s,description:n,action:r}){return e.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:s}),n&&e.jsx("p",{className:"text-gray-500",children:n})]}),r&&e.jsx("div",{children:r})]})}const xt=function(){const{prescription:n,record:r}=le({from:"/_layout/home/records/$id/prescription"});return e.jsx(Ts,{prescriptions:n.items,record:r})};export{xt as component};
