import{j as e,s as j,L as C,r as o,N as R,b as S,G as n,F as H}from"./index-BW1v2Y3o.js";import{S as L}from"./index-CT7QtIGo.js";import{T as D,a as T,b as h,c as x}from"./tabs-Bg8Hq9Zq.js";import{M as Y,a as F,H as P}from"./index-Bg0JSjC5.js";import{M as U}from"./MedicalDocumentsTab-C_mW-6if.js";import{B as i}from"./index-lZj-UG3P.js";import{I as V}from"./input-B9pFp4AM.js";import{C as O,a as B,b as z,d as _,e as E}from"./card-Bb8dNGOw.js";import{C as G,R as K}from"./RecordForm-DKCh1WY8.js";import{C as $}from"./calendar-DSwk2Pit.js";import{c as M}from"./createLucideIcon-BIXz2lW7.js";import{F as k}from"./user-BXjafA9g.js";import{a as q}from"./eye-quthMXAv.js";import{D as X}from"./upload-D_Rj1oCM.js";import{D as J,a as Q,b as W,c as Z,d as f,e as y,f as ee}from"./drawer-CY_oHpP7.js";import{A as se,a as ae,b as te,c as re,d as de,e as ne,f as ce,g as oe}from"./alert-dialog-C4OSfZMw.js";import{S as he}from"./search-CqHQ4pyN.js";import{P as I}from"./plus-Brih1OWA.js";import{X as le}from"./index-fdDP8kav.js";import{S as xe,V as ie}from"./VaccinationsTabContent-CWqiKkxh.js";/**
 * @license lucide-react v0.481.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],A=M("Clipboard",me);/**
 * @license lucide-react v0.481.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]],ue=M("UserRound",je),ge=({record:a})=>e.jsxs(O,{className:"bg-white border border-gray-100 py-4 pb-0 rounded-lg transition-all hover:shadow-md overflow-hidden",children:[e.jsxs(B,{className:"pb-3 border-b border-gray-50",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(z,{className:"text-xl font-semibold text-gray-800",children:a.title}),a.isFollowup&&e.jsxs("div",{className:"flex items-center bg-amber-50 px-3 py-2 rounded-md",children:[e.jsx(G,{className:"h-4 w-4 text-amber-600 mr-2"}),e.jsxs("span",{className:"text-sm text-amber-700",children:["Hẹn tái khám:"," ",j(a.followupDate).format("DD/MM/YYYY")]})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2 text-sm",children:[e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx($,{className:"h-4 w-4 mr-1.5"}),j(a.visitDate).format("DD/MM/YYYY")]}),e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(Y,{className:"h-4 w-4 mr-1.5"}),a.medicalFacility]})]})]}),e.jsx(_,{className:"",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"bg-blue-50 p-2 rounded-md mr-3",children:e.jsx(ue,{className:"h-5 w-5 text-health-blue"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-700 mb-1",children:"Bác sĩ"}),e.jsx("div",{className:"text-gray-600",children:a.doctorName||"Không rõ"})]})]}),a.treatment&&e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"bg-green-50 p-2 rounded-md mr-3",children:e.jsx(A,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-700 mb-1",children:"Phương pháp điều trị"}),e.jsx("div",{className:"text-gray-600",children:a.treatment})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"bg-purple-50 p-2 rounded-md mr-3",children:e.jsx(k,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-700 mb-1",children:"Ghi chú"}),e.jsx("div",{className:"text-gray-600 line-clamp-3",children:a.notes})]})]})]})}),e.jsxs(E,{className:"flex justify-between py-3 ",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["Cập nhật:"," ",j(a.updatedAt||a.createdAt).format("DD/MM/YYYY HH:mm")]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(i,{variant:"ghost",size:"sm",className:"text-gray-600 hover:bg-gray-100",asChild:!0,children:e.jsxs(C,{to:"/home/records/$id/prescription",params:{id:a.id.toString()},children:[e.jsx(q,{className:"mr-1.5 h-3.5 w-3.5"}),"Chi tiết"]})}),e.jsxs(i,{variant:"default",size:"sm",className:" text-white ",children:[e.jsx(X,{className:"mr-1.5 h-3.5 w-3.5"}),"Tải xuống"]})]})]})]});function we({memberRecords:a,profile:s}){const[r,c]=o.useState(""),[l,t]=o.useState(!1),[m,u]=o.useState(!1),[g,ve]=o.useState("add"),w=r?a.filter(d=>{var N,v,p,b;return((N=d.title)==null?void 0:N.toLowerCase().includes(r.toLowerCase()))||((v=d.medicalFacility)==null?void 0:v.toLowerCase().includes(r.toLowerCase()))||((p=d.doctorName)==null?void 0:p.toLowerCase().includes(r.toLowerCase()))||((b=d.diagnosis)==null?void 0:b.toLowerCase().includes(r.toLowerCase()))}):a;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-4 mb-4",children:[e.jsxs("div",{className:"relative w-full sm:w-auto sm:flex-grow max-w-sm",children:[e.jsx(he,{className:"absolute left-2.5 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(V,{type:"search",placeholder:"Tìm kiếm hồ sơ khám bằng tên bác sĩ, cơ sở khám, hoặc triệu chứng,...",className:"pl-8 w-full",value:r,onChange:d=>c(d.target.value)})]}),e.jsx(se,{open:m,onOpenChange:u,children:e.jsxs(ae,{children:[e.jsxs(te,{children:[e.jsx(re,{children:"Bạn đã thêm hồ sơ khám này thành công"}),e.jsx(de,{children:"Bạn có muốn kê đơn thuốc cho hồ sơ này không?"})]}),e.jsxs(ne,{children:[e.jsx(ce,{children:"Không"}),e.jsx(oe,{asChild:!0,children:e.jsx(C,{to:"/home/records/$id/prescription",params:{id:"123"},children:"Có"})})]})]})}),e.jsxs(J,{open:l,onOpenChange:t,direction:"right",children:[e.jsx(Q,{asChild:!0,children:e.jsxs(i,{className:"flex-shrink-0 ",children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),"Thêm hồ sơ khám"]})}),e.jsx(W,{className:"!max-w-3xl ",children:e.jsxs("div",{className:"mx-auto w-full max-w-3xl",children:[e.jsx(Z,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(f,{className:"text-2xl font-bold text-gray-800",children:"Thêm hồ sơ khám mới"}),e.jsxs(y,{className:"text-gray-500",children:["Hồ sơ khám cho"," ",(s==null?void 0:s.fullName)||"bệnh nhân"]})]}),e.jsx(ee,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"icon",children:e.jsx(le,{className:"h-5 w-5"})})})]})}),e.jsx("div",{className:"px-4 py-2",children:e.jsx(K,{type:g,onDone:d=>{t(!1),d&&g==="add"&&u(!0)},profileId:s.id})})]})})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:w.length>0?w.map(d=>e.jsx(ge,{record:d},d.id)):e.jsxs("div",{className:"col-span-1 md:col-span-2 text-center py-10 bg-white rounded-lg border",children:[e.jsx(k,{className:"h-12 w-12 mx-auto text-gray-300 mb-3"}),e.jsxs("h3",{className:"text-lg font-medium text-gray-600",children:["No medical records found"," ",r&&"matching your search"]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[r?"Try a different search term or ":"","Add a new record for ",s==null?void 0:s.fullName]}),e.jsxs(i,{className:"mt-4 ",onClick:()=>t(!0),children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),"Thêm hồ sơ khám"]})]})})]})}function Ne({profile:a,canRead:s=!0,canUpdate:r=!0}){const{data:c=[]}=R(a==null?void 0:a.id,{query:{enabled:!!(a!=null&&a.id)}}),[l,t]=o.useState("records");return s?e.jsx("div",{className:"flex-grow p-4 md:p-6 lg:p-8 bg-white rounded-2xl shadow-sm",children:e.jsxs(D,{value:l,onValueChange:t,className:"space-y-4",children:[e.jsx("div",{className:"overflow-x-auto pb-2",children:e.jsxs(T,{className:"bg-gray-100 border border-gray-200",children:[e.jsxs(h,{value:"records",className:"data-[state=active]:bg-white data-[state=active]:text-health-blue data-[state=active]:shadow-sm",children:[e.jsx(A,{className:"mr-1.5 h-4 w-4"}),"Records"]}),e.jsxs(h,{value:"vaccinations",className:"data-[state=active]:bg-white data-[state=active]:text-health-blue data-[state=active]:shadow-sm",children:[e.jsx(xe,{className:"mr-1.5 h-4 w-4"}),"Vaccinations"]})]})}),e.jsx(x,{value:"overview"}),e.jsx(x,{value:"records",children:e.jsx(we,{memberRecords:c,profile:a})}),e.jsx(x,{value:"medications"}),e.jsx(x,{value:"vaccinations",children:e.jsx(ie,{profileId:a==null?void 0:a.id})}),e.jsx(x,{value:"vitals"})]})}):e.jsx("div",{className:"text-center text-muted-foreground",children:"Không có quyền truy cập vào lịch sử khám bệnh này"})}function ze({profile:a,family:s,memberId:r}){const[c,l]=o.useState("personal"),t=S(m=>m.ability);return console.log(t==null?void 0:t.can("read",n("MemberDocument",{ownerId:s==null?void 0:s.ownerId,profileId:a.id})),t==null?void 0:t.rules,t),e.jsx("div",{className:"flex-1 container py-8 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center md:justify-between",children:[e.jsxs("div",{children:[s&&e.jsxs("h1",{className:"text-2xl font-bold",children:["Hồ sơ của thành viên ",e.jsx("i",{children:a==null?void 0:a.fullName})," ","trong gia đình ",e.jsx("i",{children:s.familyName})]}),!s&&e.jsxs("h1",{className:"text-2xl font-bold",children:["Hồ sơ của ",e.jsx("i",{children:a==null?void 0:a.fullName})]})]}),r&&e.jsx(H,{I:"share",a:n("MemberProfile",{ownerId:s==null?void 0:s.ownerId,profileId:a.id}),children:e.jsx(L,{familyId:s==null?void 0:s.id,memberId:r,type:"member"})})]}),e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsx(D,{defaultValue:"personal",value:c,onValueChange:l,className:"mt-4 md:mt-0 w-full",children:e.jsxs(T,{className:"w-full",children:[e.jsx(h,{value:"personal",children:"Thông tin cá nhân"}),e.jsx(h,{value:"document",children:"Tài liệu y tế"}),e.jsx(h,{value:"health",children:"Thông tin sức khỏe"}),e.jsx(h,{value:"record",children:"Hồ sơ khám"})]})}),e.jsxs("div",{className:"md:col-span-3",children:[c==="personal"&&e.jsx(F,{profile:a,canRead:t==null?void 0:t.can("read",n("MemberProfile",{ownerId:s==null?void 0:s.ownerId,profileId:a.id,familyId:s==null?void 0:s.id})),canUpdate:t==null?void 0:t.can("update",n("MemberProfile",{ownerId:s==null?void 0:s.ownerId,profileId:a.id,familyId:s==null?void 0:s.id}))}),c==="document"&&e.jsx(U,{profile:a,canRead:t==null?void 0:t.can("read",n("MemberDocument",{ownerId:s==null?void 0:s.ownerId,profileId:a.id,familyId:s==null?void 0:s.id})),canUpdate:t==null?void 0:t.can("update",n("MemberDocument",{ownerId:s==null?void 0:s.ownerId,profileId:a.id,familyId:s==null?void 0:s.id}))}),c==="health"&&e.jsx(P,{profile:a,canRead:t==null?void 0:t.can("read",n("MemberHealth",{ownerId:s==null?void 0:s.ownerId,profileId:a.id,familyId:s==null?void 0:s.id})),canUpdate:t==null?void 0:t.can("update",n("MemberHealth",{ownerId:s==null?void 0:s.ownerId,profileId:a.id,familyId:s==null?void 0:s.id}))}),c==="record"&&e.jsx(Ne,{profile:a,canRead:t==null?void 0:t.can("read",n("MemberRecord",{ownerId:s==null?void 0:s.ownerId,profileId:a.id,familyId:s==null?void 0:s.id})),canUpdate:t==null?void 0:t.can("update",n("MemberRecord",{ownerId:s==null?void 0:s.ownerId,profileId:a.id,familyId:s==null?void 0:s.id}))})]})]})]})})}export{ze as F};
