import{c as He,e as lt,d as Ne,r as p,j as n,s as _,t as Ce}from"./index-BW1v2Y3o.js";import{C as Ae,d as Ve}from"./card-Bb8dNGOw.js";import{T as ut,a as dt,b as $e,c as ne,d as mt,e as se}from"./table-DjxPWTM_.js";import{B as H,c as L,d as ft}from"./index-lZj-UG3P.js";import{I as ce}from"./input-B9pFp4AM.js";import{P as ht,a as xt,b as Ye,c as gt,e as pt}from"./pagination-C1RtrbJA.js";import{B as Oe}from"./badge-B4P0SrPl.js";import{s as U,e as Pe,c as re,P as Dt,a as jt,b as yt,C as vt}from"./popover-DmVzagL2.js";import{S as xe,a as ge,b as pe,c as De,d as je}from"./select-D2Gb7fMh.js";import{t as Nt,a as Tt}from"./en-US-5imNvEBo.js";import{C as wt}from"./calendar-DSwk2Pit.js";import{f as bt,s as Ue,a as _e,b as fe}from"./format-CR5l4UVX.js";import{e as ye}from"./endOfDay-D2_vhOVw.js";import{e as oe}from"./endOfMonth-DGAv_To5.js";import{u as Mt,s as Ct}from"./label-C5VtnZRZ.js";import{o as Yt,s as ae,b as Ot,d as St,n as qe}from"./index-B3p3PcZP.js";import{D as It,b as Ft,c as kt,d as Et,f as Lt}from"./dialog-CtifNpLo.js";import{F as Ht,a as W,b as K,c as R,d as Q,e as ee}from"./form-CBmUezT4.js";import{T as Ze}from"./textarea-DMIEle1g.js";import{C as zt}from"./checkbox-Do6_XIjt.js";import{A as At,a as Vt,b as $t,c as Pt,d as Ut,e as _t,f as qt,g as Zt}from"./alert-dialog-C4OSfZMw.js";import{S as Bt}from"./search-CqHQ4pyN.js";import{P as Be}from"./plus-Brih1OWA.js";import{S as Xt}from"./square-pen-BUiDCqt8.js";import{T as Wt}from"./trash-2-D3N7ccQE.js";import{c as Te}from"./createLucideIcon-BIXz2lW7.js";/**
 * @license lucide-react v0.481.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],Rt=Te("ArrowDown",Kt);/**
 * @license lucide-react v0.481.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],Jt=Te("ArrowUpDown",Gt);/**
 * @license lucide-react v0.481.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],en=Te("ArrowUp",Qt);/**
 * @license lucide-react v0.481.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tn=[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]],nn=Te("Syringe",tn);function Xe(t,s){const e=Nt(t,s==null?void 0:s.in),r=e.getFullYear();return e.setFullYear(r+1,0,0),e.setHours(23,59,59,999),e}function sn(){return Object.assign({},Tt())}const rn=(t,s,e)=>Ne({url:"/api/vaccinations",method:"GET",params:t,signal:e},s),on=t=>["/api/vaccinations",...t?[t]:[]],an=(t,s)=>{const{query:e,request:r}=s??{};return{queryKey:(e==null?void 0:e.queryKey)??on(t),queryFn:({signal:c})=>rn(t,r,c),...e}};function cn(t,s,e){const r=an(t,s),o=lt(r);return o.queryKey=r.queryKey,o}const ln=(t,s,e)=>Ne({url:"/api/vaccinations",method:"POST",headers:{"Content-Type":"application/json"},data:t,signal:e},s),un=t=>{const s=["createVaccination"],{mutation:e,request:r}={mutation:{mutationKey:s},request:void 0};return{mutationFn:a=>{const{data:c}=a??{};return ln(c,r)},...e}},dn=(t,s)=>{const e=un();return He(e)},mn=(t,s)=>Ne({url:`/api/vaccinations/${t}`,method:"DELETE"},s),fn=t=>{const s=["deleteVaccination"],{mutation:e,request:r}={mutation:{mutationKey:s},request:void 0};return{mutationFn:a=>{const{id:c}=a??{};return mn(c,r)},...e}},hn=(t,s)=>{const e=fn();return He(e)},xn=(t,s,e)=>Ne({url:`/api/vaccinations/${t}`,method:"PATCH",headers:{"Content-Type":"application/json"},data:s},e),gn=t=>{const s=["updateVaccination"],{mutation:e,request:r}={mutation:{mutationKey:s},request:void 0};return{mutationFn:a=>{const{id:c,data:x}=a??{};return xn(c,x,r)},...e}},pn=(t,s)=>{const e=gn();return He(e)};function We(t,s,e){const r=sn(),o=yn(t,e.timeZone,e.locale??r.locale);return"formatToParts"in o?Dn(o,s):jn(o,s)}function Dn(t,s){const e=t.formatToParts(s);for(let r=e.length-1;r>=0;--r)if(e[r].type==="timeZoneName")return e[r].value}function jn(t,s){const e=t.format(s).replace(/\u200E/g,""),r=/ [\w-+ ]+$/.exec(e);return r?r[0].substr(1):""}function yn(t,s,e){return new Intl.DateTimeFormat(e?[e.code,"en-US"]:void 0,{timeZone:s,timeZoneName:t})}function vn(t,s){const e=Mn(s);return"formatToParts"in e?Tn(e,t):wn(e,t)}const Nn={year:0,month:1,day:2,hour:3,minute:4,second:5};function Tn(t,s){try{const e=t.formatToParts(s),r=[];for(let o=0;o<e.length;o++){const a=Nn[e[o].type];a!==void 0&&(r[a]=parseInt(e[o].value,10))}return r}catch(e){if(e instanceof RangeError)return[NaN];throw e}}function wn(t,s){const e=t.format(s),r=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(e);return[parseInt(r[3],10),parseInt(r[1],10),parseInt(r[2],10),parseInt(r[4],10),parseInt(r[5],10),parseInt(r[6],10)]}const Se={},Ke=new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:"America/New_York",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),bn=Ke==="06/25/2014, 00:00:00"||Ke==="‎06‎/‎25‎/‎2014‎ ‎00‎:‎00‎:‎00";function Mn(t){return Se[t]||(Se[t]=bn?new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:t,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),Se[t]}function ot(t,s,e,r,o,a,c){const x=new Date(0);return x.setUTCFullYear(t,s,e),x.setUTCHours(r,o,a,c),x}const Re=36e5,Cn=6e4,Ie={timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-])(\d{2}):?(\d{2})$/};function ze(t,s,e){if(!t)return 0;let r=Ie.timezoneZ.exec(t);if(r)return 0;let o,a;if(r=Ie.timezoneHH.exec(t),r)return o=parseInt(r[1],10),Ge(o)?-(o*Re):NaN;if(r=Ie.timezoneHHMM.exec(t),r){o=parseInt(r[2],10);const c=parseInt(r[3],10);return Ge(o,c)?(a=Math.abs(o)*Re+c*Cn,r[1]==="+"?-a:a):NaN}if(Sn(t)){s=new Date(s||Date.now());const c=e?s:Yn(s),x=Le(c,t);return-(e?x:On(s,x,t))}return NaN}function Yn(t){return ot(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())}function Le(t,s){const e=vn(t,s),r=ot(e[0],e[1]-1,e[2],e[3]%24,e[4],e[5],0).getTime();let o=t.getTime();const a=o%1e3;return o-=a>=0?a:1e3+a,r-o}function On(t,s,e){let o=t.getTime()-s;const a=Le(new Date(o),e);if(s===a)return s;o-=a-s;const c=Le(new Date(o),e);return a===c?a:Math.max(a,c)}function Ge(t,s){return-23<=t&&t<=23&&(s==null||0<=s&&s<=59)}const Je={};function Sn(t){if(Je[t])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:t}),Je[t]=!0,!0}catch{return!1}}const In=60*1e3,Fn={X:function(t,s,e){const r=Fe(e.timeZone,t);if(r===0)return"Z";switch(s){case"X":return Qe(r);case"XXXX":case"XX":return le(r);case"XXXXX":case"XXX":default:return le(r,":")}},x:function(t,s,e){const r=Fe(e.timeZone,t);switch(s){case"x":return Qe(r);case"xxxx":case"xx":return le(r);case"xxxxx":case"xxx":default:return le(r,":")}},O:function(t,s,e){const r=Fe(e.timeZone,t);switch(s){case"O":case"OO":case"OOO":return"GMT"+kn(r,":");case"OOOO":default:return"GMT"+le(r,":")}},z:function(t,s,e){switch(s){case"z":case"zz":case"zzz":return We("short",t,e);case"zzzz":default:return We("long",t,e)}}};function Fe(t,s){const e=t?ze(t,s,!0)/In:(s==null?void 0:s.getTimezoneOffset())??0;if(Number.isNaN(e))throw new RangeError("Invalid time zone specified: "+t);return e}function ve(t,s){const e=t<0?"-":"";let r=Math.abs(t).toString();for(;r.length<s;)r="0"+r;return e+r}function le(t,s=""){const e=t>0?"-":"+",r=Math.abs(t),o=ve(Math.floor(r/60),2),a=ve(Math.floor(r%60),2);return e+o+s+a}function Qe(t,s){return t%60===0?(t>0?"-":"+")+ve(Math.abs(t)/60,2):le(t,s)}function kn(t,s=""){const e=t>0?"-":"+",r=Math.abs(t),o=Math.floor(r/60),a=r%60;return a===0?e+String(o):e+String(o)+s+ve(a,2)}function et(t){const s=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return s.setUTCFullYear(t.getFullYear()),+t-+s}const En=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,ke=36e5,tt=6e4,Ln=2,b={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:En};function y(t,s={}){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(t===null)return new Date(NaN);const e=s.additionalDigits==null?Ln:Number(s.additionalDigits);if(e!==2&&e!==1&&e!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]")return new Date(t.getTime());if(typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]")return new Date(t);if(Object.prototype.toString.call(t)!=="[object String]")return new Date(NaN);const r=Hn(t),{year:o,restDateString:a}=zn(r.date,e),c=An(a,o);if(c===null||isNaN(c.getTime()))return new Date(NaN);if(c){const x=c.getTime();let v=0,N;if(r.time&&(v=Vn(r.time),v===null||isNaN(v)))return new Date(NaN);if(r.timeZone||s.timeZone){if(N=ze(r.timeZone||s.timeZone,new Date(x+v)),isNaN(N))return new Date(NaN)}else N=et(new Date(x+v)),N=et(new Date(x+v+N));return new Date(x+v+N)}else return new Date(NaN)}function Hn(t){const s={};let e=b.dateTimePattern.exec(t),r;if(e?(s.date=e[1],r=e[3]):(e=b.datePattern.exec(t),e?(s.date=e[1],r=e[2]):(s.date=null,r=t)),r){const o=b.timeZone.exec(r);o?(s.time=r.replace(o[1],""),s.timeZone=o[1].trim()):s.time=r}return s}function zn(t,s){if(t){const e=b.YYY[s],r=b.YYYYY[s];let o=b.YYYY.exec(t)||r.exec(t);if(o){const a=o[1];return{year:parseInt(a,10),restDateString:t.slice(a.length)}}if(o=b.YY.exec(t)||e.exec(t),o){const a=o[1];return{year:parseInt(a,10)*100,restDateString:t.slice(a.length)}}}return{year:null}}function An(t,s){if(s===null)return null;let e,r,o;if(!t||!t.length)return e=new Date(0),e.setUTCFullYear(s),e;let a=b.MM.exec(t);if(a)return e=new Date(0),r=parseInt(a[1],10)-1,st(s,r)?(e.setUTCFullYear(s,r),e):new Date(NaN);if(a=b.DDD.exec(t),a){e=new Date(0);const c=parseInt(a[1],10);return Un(s,c)?(e.setUTCFullYear(s,0,c),e):new Date(NaN)}if(a=b.MMDD.exec(t),a){e=new Date(0),r=parseInt(a[1],10)-1;const c=parseInt(a[2],10);return st(s,r,c)?(e.setUTCFullYear(s,r,c),e):new Date(NaN)}if(a=b.Www.exec(t),a)return o=parseInt(a[1],10)-1,rt(o)?nt(s,o):new Date(NaN);if(a=b.WwwD.exec(t),a){o=parseInt(a[1],10)-1;const c=parseInt(a[2],10)-1;return rt(o,c)?nt(s,o,c):new Date(NaN)}return null}function Vn(t){let s,e,r=b.HH.exec(t);if(r)return s=parseFloat(r[1].replace(",",".")),Ee(s)?s%24*ke:NaN;if(r=b.HHMM.exec(t),r)return s=parseInt(r[1],10),e=parseFloat(r[2].replace(",",".")),Ee(s,e)?s%24*ke+e*tt:NaN;if(r=b.HHMMSS.exec(t),r){s=parseInt(r[1],10),e=parseInt(r[2],10);const o=parseFloat(r[3].replace(",","."));return Ee(s,e,o)?s%24*ke+e*tt+o*1e3:NaN}return null}function nt(t,s,e){s=s||0,e=e||0;const r=new Date(0);r.setUTCFullYear(t,0,4);const o=r.getUTCDay()||7,a=s*7+e+1-o;return r.setUTCDate(r.getUTCDate()+a),r}const $n=[31,28,31,30,31,30,31,31,30,31,30,31],Pn=[31,29,31,30,31,30,31,31,30,31,30,31];function at(t){return t%400===0||t%4===0&&t%100!==0}function st(t,s,e){if(s<0||s>11)return!1;if(e!=null){if(e<1)return!1;const r=at(t);if(r&&e>Pn[s]||!r&&e>$n[s])return!1}return!0}function Un(t,s){if(s<1)return!1;const e=at(t);return!(e&&s>366||!e&&s>365)}function rt(t,s){return!(t<0||t>52||s!=null&&(s<0||s>6))}function Ee(t,s,e){return!(t<0||t>=25||s!=null&&(s<0||s>=60)||e!=null&&(e<0||e>=60))}const _n=/([xXOz]+)|''|'(''|[^'])+('|$)/g;function qn(t,s,e={}){s=String(s);const r=s.match(_n);if(r){const o=y(e.originalDate||t,e);s=r.reduce(function(a,c){if(c[0]==="'")return a;const x=a.indexOf(c),v=a[x-1]==="'",N=a.replace(c,"'"+Fn[c[0]](o,c,e)+"'");return v?N.substring(0,x-1)+N.substring(x+1):N},s)}return bt(t,s,e)}function Zn(t,s,e){t=y(t,e);const r=ze(s,t,!0),o=new Date(t.getTime()-r),a=new Date(0);return a.setFullYear(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate()),a.setHours(o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds(),o.getUTCMilliseconds()),a}function Bn(t,s,e,r){return r={...r,timeZone:s,originalDate:t},qn(Zn(t,s,{timeZone:r.timeZone}),e,r)}const ie=["January","February","March","April","May","June","July","August","September","October","November","December"],Xn=ft("flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium text-foreground ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground text-background",link:"text-primary underline-offset-4 hover:underline text-background"}},defaultVariants:{variant:"default"}}),it=p.forwardRef(({id:t="calendar-date-picker",className:s,date:e,closeOnSelect:r=!1,numberOfMonths:o=2,yearsRange:a=10,onDateSelect:c,variant:x,placeholder:v,...N},T)=>{var de,m,C;const[z,u]=p.useState(!1),[I,M]=p.useState(o===2?"This Year":"Today"),[w,Y]=p.useState(e==null?void 0:e.from),[V,q]=p.useState((de=e==null?void 0:e.from)==null?void 0:de.getFullYear()),[A,O]=p.useState(o===2?e==null?void 0:e.to:e==null?void 0:e.from),[$,Z]=p.useState(o===2?(m=e==null?void 0:e.to)==null?void 0:m.getFullYear():(C=e==null?void 0:e.from)==null?void 0:C.getFullYear()),[f,G]=p.useState(null),D=Intl.DateTimeFormat().resolvedOptions().timeZone,he=()=>u(!1),we=()=>u(i=>!i),be=(i,d,l)=>{const g=fe(y(i,{timeZone:D})),j=o===2?ye(y(d,{timeZone:D})):g;c({from:g,to:j}),M(l),Y(i),q(i.getFullYear()),O(d),Z(d.getFullYear()),r&&u(!1)},Me=i=>{if(i){let d=fe(y(i.from,{timeZone:D})),l=i.to?ye(y(i.to,{timeZone:D})):d;o===1&&(i.from!==e.from?l=d:d=fe(y(i.to,{timeZone:D}))),c({from:d,to:l}),Y(d),q(d.getFullYear()),O(l),Z(l.getFullYear())}M(null)},F=(i,d)=>{if(M(null),d==="from"){if(V!==void 0){if(i<0||i>a+1)return;const l=new Date(V,i,1),g=o===2?re(y(l,{timeZone:D})):e!=null&&e.from?new Date(e.from.getFullYear(),l.getMonth(),e.from.getDate()):l,j=o===2?e.to?ye(y(e.to,{timeZone:D})):oe(y(l,{timeZone:D})):g;g<=j&&(c({from:g,to:j}),Y(l),O(e.to))}}else if($!==void 0){if(i<0||i>a+1)return;const l=new Date($,i,1),g=e.from?fe(y(e.from,{timeZone:D})):re(y(l,{timeZone:D})),j=o===2?oe(y(l,{timeZone:D})):g;g<=j&&(c({from:g,to:j}),O(l),Y(e.from))}},te=(i,d)=>{var l,g;if(M(null),d==="from"){if(J.includes(i)){const j=w?new Date(i,w?w.getMonth():0,1):new Date(i,0,1),P=o===2?re(y(j,{timeZone:D})):e.from?new Date(i,j.getMonth(),e.from.getDate()):j,X=o===2?e.to?ye(y(e.to,{timeZone:D})):oe(y(j,{timeZone:D})):P;P<=X&&(c({from:P,to:X}),q(i),Y(j),Z((l=e.to)==null?void 0:l.getFullYear()),O(e.to))}}else if(J.includes(i)){const j=A?new Date(i,A.getMonth(),1):new Date(i,0,1),P=e.from?fe(y(e.from,{timeZone:D})):re(y(j,{timeZone:D})),X=o===2?oe(y(j,{timeZone:D})):P;P<=X&&(c({from:P,to:X}),Z(i),O(j),q((g=e.from)==null?void 0:g.getFullYear()),Y(e.from))}},h=new Date,J=Array.from({length:a+1},(i,d)=>h.getFullYear()-a/2+d),B=[{label:"Today",start:h,end:h},{label:"Yesterday",start:U(h,1),end:U(h,1)},{label:"This Week",start:Ue(h,{weekStartsOn:1}),end:Pe(h,{weekStartsOn:1})},{label:"Last Week",start:U(Ue(h,{weekStartsOn:1}),7),end:U(Pe(h,{weekStartsOn:1}),7)},{label:"Last 7 Days",start:U(h,6),end:h},{label:"This Month",start:re(h),end:oe(h)},{label:"Last Month",start:re(U(h,h.getDate())),end:oe(U(h,h.getDate()))},{label:"This Year",start:_e(h),end:Xe(h)},{label:"Last Year",start:_e(U(h,365)),end:Xe(U(h,365))}],k=i=>{G(i)},E=()=>{G(null)},ue=(i,d)=>{if(i.preventDefault(),M(null),f==="firstDay"){const l=new Date(e.from),g=i.deltaY>0?-1:1;l.setDate(l.getDate()+g),l<=e.to?(c(o===2?{from:l,to:new Date(e.to)}:{from:l,to:l}),Y(l)):l>e.to&&o===1&&(c({from:l,to:l}),Y(l))}else if(f==="firstMonth"){const g=(w?w.getMonth():0)+(i.deltaY>0?-1:1);F(g,"from")}else if(f==="firstYear"&&V!==void 0){const l=V+(i.deltaY>0?-1:1);te(l,"from")}else if(f==="secondDay"){const l=new Date(e.to),g=i.deltaY>0?-1:1;l.setDate(l.getDate()+g),l>=e.from&&(c({from:new Date(e.from),to:l}),O(l))}else if(f==="secondMonth"){const g=(A?A.getMonth():0)+(i.deltaY>0?-1:1);F(g,"to")}else if(f==="secondYear"&&$!==void 0){const l=$+(i.deltaY>0?-1:1);te(l,"to")}};p.useEffect(()=>{const i=document.getElementById(`firstDay-${t}`),d=document.getElementById(`firstMonth-${t}`),l=document.getElementById(`firstYear-${t}`),g=document.getElementById(`secondDay-${t}`),j=document.getElementById(`secondMonth-${t}`),P=document.getElementById(`secondYear-${t}`),X=[i,d,l,g,j,P],ct=me=>{me&&me.addEventListener("wheel",ue,{passive:!1})};return X.forEach(ct),()=>{X.forEach(me=>{me&&me.removeEventListener("wheel",ue)})}},[f,e]);const S=(i,d)=>Bn(i,D,d);return n.jsxs(n.Fragment,{children:[n.jsx("style",{children:`
            .date-part {
              touch-action: none;
            }
          `}),n.jsxs(Dt,{open:z,onOpenChange:u,modal:!0,children:[n.jsx(jt,{asChild:!0,children:n.jsxs(H,{id:"date",ref:T,...N,className:L("w-auto",Xn({variant:x,className:s})),onClick:we,suppressHydrationWarning:!0,children:[n.jsx(wt,{className:"mr-2 h-4 w-4"}),n.jsx("span",{children:e!=null&&e.from?e.to?n.jsxs(n.Fragment,{children:[n.jsx("span",{id:`firstDay-${t}`,className:L("date-part",f==="firstDay"&&"underline font-bold"),onMouseOver:()=>k("firstDay"),onMouseLeave:E,children:S(e.from,"dd")})," ",n.jsx("span",{id:`firstMonth-${t}`,className:L("date-part",f==="firstMonth"&&"underline font-bold"),onMouseOver:()=>k("firstMonth"),onMouseLeave:E,children:S(e.from,"LLL")}),","," ",n.jsx("span",{id:`firstYear-${t}`,className:L("date-part",f==="firstYear"&&"underline font-bold"),onMouseOver:()=>k("firstYear"),onMouseLeave:E,children:S(e.from,"y")}),o===2&&n.jsxs(n.Fragment,{children:[" - ",n.jsx("span",{id:`secondDay-${t}`,className:L("date-part",f==="secondDay"&&"underline font-bold"),onMouseOver:()=>k("secondDay"),onMouseLeave:E,children:S(e.to,"dd")})," ",n.jsx("span",{id:`secondMonth-${t}`,className:L("date-part",f==="secondMonth"&&"underline font-bold"),onMouseOver:()=>k("secondMonth"),onMouseLeave:E,children:S(e.to,"LLL")}),","," ",n.jsx("span",{id:`secondYear-${t}`,className:L("date-part",f==="secondYear"&&"underline font-bold"),onMouseOver:()=>k("secondYear"),onMouseLeave:E,children:S(e.to,"y")})]})]}):n.jsxs(n.Fragment,{children:[n.jsx("span",{id:"day",className:L("date-part",f==="day"&&"underline font-bold"),onMouseOver:()=>k("day"),onMouseLeave:E,children:S(e.from,"dd")})," ",n.jsx("span",{id:"month",className:L("date-part",f==="month"&&"underline font-bold"),onMouseOver:()=>k("month"),onMouseLeave:E,children:S(e.from,"LLL")}),","," ",n.jsx("span",{id:"year",className:L("date-part",f==="year"&&"underline font-bold"),onMouseOver:()=>k("year"),onMouseLeave:E,children:S(e.from,"y")})]}):n.jsx("span",{children:v||"Select date"})})]})}),z&&n.jsx(yt,{className:"w-auto !pointer-events-auto",align:"center",avoidCollisions:!1,onInteractOutside:he,onEscapeKeyDown:he,style:{maxHeight:"var(--radix-popover-content-available-height)",overflowY:"auto"},children:n.jsxs("div",{className:"flex",children:[o===2&&n.jsx("div",{className:"hidden md:flex flex-col gap-1 pr-4 text-left border-r border-foreground/10",children:B.map(({label:i,start:d,end:l})=>n.jsx(H,{variant:"ghost",size:"sm",className:L("justify-start hover:bg-primary/90 hover:text-background",I===i&&"bg-primary text-background hover:bg-primary/90 hover:text-background"),onClick:()=>{be(d,l,i),Y(d),q(d.getFullYear()),O(l),Z(l.getFullYear())},children:i},i))}),n.jsxs("div",{className:"flex flex-col",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex gap-2 ml-3",children:[n.jsxs(xe,{onValueChange:i=>{F(ie.indexOf(i),"from"),M(null)},value:w?ie[w.getMonth()]:void 0,children:[n.jsx(ge,{className:"hidden sm:flex w-[122px] focus:ring-0 focus:ring-offset-0 font-medium hover:bg-accent hover:text-accent-foreground",children:n.jsx(pe,{placeholder:"Month"})}),n.jsx(De,{children:ie.map((i,d)=>n.jsx(je,{value:i,children:i},d))})]}),n.jsxs(xe,{onValueChange:i=>{te(Number(i),"from"),M(null)},value:V?V.toString():void 0,children:[n.jsx(ge,{className:"hidden sm:flex w-[122px] focus:ring-0 focus:ring-offset-0 font-medium hover:bg-accent hover:text-accent-foreground",children:n.jsx(pe,{placeholder:"Year"})}),n.jsx(De,{children:J.map((i,d)=>n.jsx(je,{value:i.toString(),children:i},d))})]})]}),o===2&&n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(xe,{onValueChange:i=>{F(ie.indexOf(i),"to"),M(null)},value:A?ie[A.getMonth()]:void 0,children:[n.jsx(ge,{className:"hidden sm:flex w-[122px] focus:ring-0 focus:ring-offset-0 font-medium hover:bg-accent hover:text-accent-foreground",children:n.jsx(pe,{placeholder:"Month"})}),n.jsx(De,{children:ie.map((i,d)=>n.jsx(je,{value:i,children:i},d))})]}),n.jsxs(xe,{onValueChange:i=>{te(Number(i),"to"),M(null)},value:$?$.toString():void 0,children:[n.jsx(ge,{className:"hidden sm:flex w-[122px] focus:ring-0 focus:ring-offset-0 font-medium hover:bg-accent hover:text-accent-foreground",children:n.jsx(pe,{placeholder:"Year"})}),n.jsx(De,{children:J.map((i,d)=>n.jsx(je,{value:i.toString(),children:i},d))})]})]})]}),n.jsx("div",{className:"flex",children:n.jsx(vt,{mode:"range",defaultMonth:w,month:w,onMonthChange:Y,selected:e,onSelect:Me,numberOfMonths:o,showOutsideDays:!1,className:s})})]})]})})]})]})});it.displayName="CalendarDatePicker";const Wn=Yt({id:qe().optional(),profileId:qe(),vaccineName:ae().min(1,{message:"Tên vắc-xin là bắt buộc"}),vaccinationDate:St({required_error:"Ngày tiêm chủng là bắt buộc"}),dose:ae().optional(),isDone:Ot().default(!1),batchNumber:ae().optional(),location:ae().optional(),reactions:ae().optional(),notes:ae().optional()}),Kn={vaccineName:"",isDone:!1,dose:"",batchNumber:"",location:"",reactions:"",notes:""};function Rn({isOpen:t,onClose:s,vaccination:e,profileId:r,onSuccess:o}){const a=!!(e!=null&&e.id),[c,x]=p.useState(!1),v=dn(),N=pn(),T=Mt({resolver:Ct(Wn),defaultValues:a?{...e,isDone:e.done,vaccinationDate:e.vaccinationDate?_(e.vaccinationDate).toDate():void 0}:{...Kn,profileId:r}}),z=async u=>{try{x(!0);const I={...u,vaccinationDate:_(u.vaccinationDate).format()};a?await N.mutateAsync({id:e.id,data:{...I,profileId:e.profileId,vaccinationDate:_(u.vaccinationDate).format("YYYY-MM-DDTHH:mm:ss"),done:u.isDone}}):await v.mutateAsync({data:{...I,profileId:u.profileId,vaccinationDate:_(u.vaccinationDate).format("YYYY-MM-DDTHH:mm:ss"),done:u.isDone}}),o(),s()}catch(I){console.error("Lỗi khi lưu thông tin tiêm chủng:",I)}finally{x(!1)}};return n.jsx(It,{open:t,onOpenChange:u=>!u&&s(),children:n.jsxs(Ft,{className:"sm:max-w-[550px]",children:[n.jsx(kt,{children:n.jsx(Et,{children:a?"Chỉnh sửa thông tin tiêm chủng":"Thêm thông tin tiêm chủng mới"})}),n.jsx(Ht,{...T,children:n.jsxs("form",{onSubmit:T.handleSubmit(z),className:"space-y-4",children:[n.jsx(W,{control:T.control,name:"vaccineName",render:({field:u})=>n.jsxs(K,{children:[n.jsx(R,{children:"Tên vắc-xin*"}),n.jsx(Q,{children:n.jsx(ce,{placeholder:"Nhập tên vắc-xin",...u})}),n.jsx(ee,{})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsx(W,{control:T.control,name:"vaccinationDate",render:({field:u})=>{var I;return n.jsxs(K,{className:"flex flex-col",children:[n.jsx(R,{children:"Ngày tiêm chủng*"}),n.jsx(ce,{type:"date",value:(I=u.value)==null?void 0:I.toISOString().split("T")[0],onChange:M=>{const w=new Date(M.target.value);u.onChange(w)},placeholder:"Chọn ngày tiêm chủng"}),n.jsx(ee,{})]})}}),n.jsx(W,{control:T.control,name:"dose",render:({field:u})=>n.jsxs(K,{children:[n.jsx(R,{children:"Liều"}),n.jsx(Q,{children:n.jsx(ce,{placeholder:"Số liều hoặc loại liều",...u})}),n.jsx(ee,{})]})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsx(W,{control:T.control,name:"batchNumber",render:({field:u})=>n.jsxs(K,{children:[n.jsx(R,{children:"Số lô"}),n.jsx(Q,{children:n.jsx(ce,{placeholder:"Số lô vắc-xin",...u})}),n.jsx(ee,{})]})}),n.jsx(W,{control:T.control,name:"location",render:({field:u})=>n.jsxs(K,{children:[n.jsx(R,{children:"Địa điểm"}),n.jsx(Q,{children:n.jsx(ce,{placeholder:"Địa điểm tiêm chủng",...u})}),n.jsx(ee,{})]})})]}),n.jsx(W,{control:T.control,name:"reactions",render:({field:u})=>n.jsxs(K,{children:[n.jsx(R,{children:"Phản ứng"}),n.jsx(Q,{children:n.jsx(Ze,{placeholder:"Phản ứng sau tiêm (nếu có)",className:"resize-none",rows:2,...u})}),n.jsx(ee,{})]})}),n.jsx(W,{control:T.control,name:"notes",render:({field:u})=>n.jsxs(K,{children:[n.jsx(R,{children:"Ghi chú"}),n.jsx(Q,{children:n.jsx(Ze,{placeholder:"Ghi chú bổ sung",className:"resize-none",rows:2,...u})}),n.jsx(ee,{})]})}),n.jsx(W,{control:T.control,name:"isDone",render:({field:u})=>n.jsxs(K,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[n.jsx(Q,{children:n.jsx(zt,{checked:u.value,onCheckedChange:u.onChange})}),n.jsx("div",{className:"space-y-1 leading-none",children:n.jsx(R,{children:"Đã hoàn thành tiêm chủng"})})]})}),n.jsxs(Lt,{children:[n.jsx(H,{type:"button",variant:"outline",onClick:s,disabled:c,children:"Hủy"}),n.jsx(H,{type:"submit",disabled:c,children:c?"Đang lưu...":a?"Cập nhật":"Lưu"})]})]})})]})})}function Gn({isOpen:t,onClose:s,onConfirm:e,title:r,description:o,isLoading:a=!1}){return n.jsx(At,{open:t,onOpenChange:c=>!c&&s(),children:n.jsxs(Vt,{children:[n.jsxs($t,{children:[n.jsx(Pt,{children:r}),n.jsx(Ut,{children:o})]}),n.jsxs(_t,{children:[n.jsx(qt,{disabled:a,children:"Cancel"}),n.jsx(Zt,{onClick:c=>{c.preventDefault(),e()},disabled:a,className:"bg-destructive hover:bg-destructive/90",children:a?"Deleting...":"Delete"})]})]})})}function bs({profileId:t}){var de;const[s,e]=p.useState(""),[r,o]=p.useState(void 0),[a,c]=p.useState(void 0),[x,v]=p.useState("vaccinationDate"),[N,T]=p.useState("DESC"),[z,u]=p.useState(0),I=20,[M,w]=p.useState(!1),[Y,V]=p.useState(null),[q,A]=p.useState(!1),[O,$]=p.useState(null),Z=hn(),[f,G]=p.useState({keyword:"",fromDate:void 0,toDate:void 0,sortBy:"vaccinationDate",sortDirection:"DESC"}),D=()=>{V(null),w(!0)},he=m=>{V(m),w(!0)},we=m=>{$(m),A(!0)},be=async()=>{if(O)try{await Z.mutateAsync({id:O.id}),Ce("Vắcxin đã được xóa thành công"),h()}catch{Ce.error("Xóa vắc xin không thành công",{description:"Vui lòng thử lại sau."})}finally{A(!1),$(null)}},Me=()=>{h(),Ce(Y?"Cập nhật vắc xin thành công":"Thêm vắc xin thành công")},{data:F,isLoading:te,refetch:h}=cn({profileId:t,fromDate:f.fromDate?_(f.fromDate).startOf("day").toISOString().replace("Z",""):void 0,toDate:f.toDate?_(f.toDate).endOf("day").toISOString().replace("Z",""):void 0,keyword:f.keyword,sortBy:f.sortBy,sortDirection:f.sortDirection,page:z,size:I},{query:{enabled:!!t}}),J=(F==null?void 0:F.content)||[],B=((de=F==null?void 0:F.page)==null?void 0:de.totalPages)||0,k=()=>{G({keyword:s,fromDate:r,toDate:a,sortBy:x,sortDirection:N}),u(0),h()},E=()=>{e(""),o(void 0),c(void 0),v("vaccinationDate"),T("DESC"),u(0),G({keyword:"",fromDate:void 0,toDate:void 0,sortBy:"vaccinationDate",sortDirection:"DESC"}),h()},ue=p.useCallback(m=>{if(f.sortBy===m){const C=f.sortDirection==="ASC"?"DESC":"ASC";G(i=>({...i,sortDirection:C})),T(C)}else G(C=>({...C,sortBy:m,sortDirection:"DESC"})),v(m),T("DESC");h()},[f.sortBy,f.sortDirection,h]),S=m=>f.sortBy!==m?n.jsx(Jt,{className:"ml-1 h-4 w-4"}):f.sortDirection==="ASC"?n.jsx(en,{className:"ml-1 h-4 w-4"}):n.jsx(Rt,{className:"ml-1 h-4 w-4"});return n.jsxs("div",{className:"space-y-4",children:[n.jsx(Ae,{children:n.jsxs(Ve,{className:"pt-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[n.jsx("div",{children:n.jsxs("div",{className:"relative",children:[n.jsx(Bt,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),n.jsx(ce,{placeholder:"Tìm kiếm theo tên vắc xin, địa điểm,...",value:s,onChange:m=>e(m.target.value),className:"pl-8"})]})}),n.jsx("div",{className:"flex justify-end gap-2",children:n.jsx(it,{date:{from:r,to:a},onDateSelect:({from:m,to:C})=>{o(m),c(C)},className:"",id:"date-range-from",placeholder:"Khoảng thời gian"})})]}),n.jsxs("div",{className:"flex justify-end gap-2",children:[n.jsx(H,{variant:"outline",onClick:E,children:"Xóa bộ lọc"}),n.jsx(H,{onClick:k,children:"Áp dụng bộ lọc"})]})]})}),n.jsx("div",{className:"flex justify-end mb-4",children:n.jsxs(H,{onClick:D,children:[n.jsx(Be,{className:"mr-2 h-4 w-4"}),"Tạo lịch tiêm"]})}),n.jsx(Ae,{children:n.jsx(Ve,{className:"pt-6",children:te?n.jsx("div",{className:"text-center py-10",children:"Loading vaccination records..."}):J.length>0?n.jsxs(n.Fragment,{children:[n.jsxs(ut,{children:[n.jsx(dt,{children:n.jsxs($e,{children:[n.jsx(ne,{children:"#Id"}),n.jsx(ne,{className:"cursor-pointer",onClick:()=>ue("vaccineName"),children:n.jsxs("div",{className:"flex items-center",children:["Tên vắc xin",S("vaccineName")]})}),n.jsx(ne,{children:"Địa điểm"}),n.jsx(ne,{className:"cursor-pointer",onClick:()=>ue("vaccinationDate"),children:n.jsxs("div",{className:"flex items-center",children:["Ngày tiêm",S("vaccinationDate")]})}),n.jsx(ne,{children:"Trạng thái"}),n.jsx(ne,{children:"Hành động"})]})}),n.jsx(mt,{children:J.map(m=>n.jsxs($e,{children:[n.jsx(se,{className:"font-medium",children:m.id}),n.jsx(se,{className:"font-medium",children:m.vaccineName}),n.jsx(se,{className:"truncate",children:m.location}),n.jsx(se,{children:_(m.vaccinationDate).format("DD/MM/YYYY HH:mm")}),n.jsx(se,{children:n.jsx(Jn,{date:m.vaccinationDate,done:m.done})}),n.jsx(se,{children:n.jsxs("div",{className:"flex space-x-2",children:[n.jsx(H,{variant:"ghost",size:"sm",onClick:()=>he(m),children:n.jsx(Xt,{className:"h-4 w-4 text-yellow-500"})}),n.jsx(H,{variant:"ghost",size:"sm",onClick:()=>we(m),children:n.jsx(Wt,{className:"h-4 w-4 text-red-500"})})]})})]},m.id))})]}),B>1&&n.jsx("div",{className:"mt-4 flex justify-center",children:n.jsx(ht,{children:n.jsxs(xt,{children:[n.jsx(Ye,{children:n.jsx(gt,{onClick:()=>u(m=>Math.max(0,m-1))})}),Array.from({length:Math.min(5,B)}).map((m,C)=>{let i;return B<=5||z<3?i=C:z>B-4?i=B-5+C:i=z-2+C,n.jsx(Ye,{children:n.jsx(H,{variant:z===i?"default":"outline",size:"sm",onClick:()=>u(i),children:i+1})},i)}),n.jsx(Ye,{children:n.jsx(pt,{onClick:()=>u(m=>Math.min(B-1,m+1))})})]})})})]}):n.jsxs("div",{className:"text-center py-10",children:[n.jsx(nn,{className:"h-12 w-12 mx-auto text-gray-300 mb-3"}),n.jsx("h3",{className:"text-lg font-medium text-gray-600",children:"Không tìm thấy lịch tiêm nào"}),n.jsx("p",{className:"text-sm text-gray-500",children:"Vui lòng thêm lịch tiêm mới để theo dõi sức khoẻ của bạn."}),n.jsxs(H,{className:"mt-4",onClick:D,children:[n.jsx(Be,{className:"mr-2 h-4 w-4"}),"Tạo lịch tiêm"]})]})})}),M&&n.jsx(Rn,{isOpen:M,onClose:()=>w(!1),vaccination:Y,profileId:t,onSuccess:Me}),q&&O&&n.jsx(Gn,{isOpen:q,onClose:()=>A(!1),onConfirm:be,title:"Xác nhận xoá lịch tiêm",description:`Bạn có chắc chắn muốn xóa lịch tiêm ${O.vaccineName} không?`,isLoading:Z.isPending})]})}const Jn=({date:t,done:s})=>{const e=_(t).isBefore(_())&&!s;return s?n.jsx(Oe,{variant:"default",children:"Đã tiêm"}):e?n.jsx(Oe,{variant:"destructive",children:"Trễ hạn tiêm"}):n.jsx(Oe,{variant:"secondary",children:"Chưa tiêm"})};export{nn as S,bs as V};
