import{u as B,r as c,g as L,j as e}from"./index-BW1v2Y3o.js";import{I as V}from"./input-B9pFp4AM.js";import{B as z}from"./index-lZj-UG3P.js";import{S as J,a as $,b as K,c as O,d as u}from"./select-D2Gb7fMh.js";import{T as Q,a as _,b as g,c as l,d as U,e as a}from"./table-DjxPWTM_.js";import{P as W,a as Y,b as C,c as Z,d as ee,e as se}from"./pagination-C1RtrbJA.js";import{A as ne,a as te,b as ae,c as ie,d as le,e as re,f as ce,g as oe}from"./alert-dialog-C4OSfZMw.js";import{D as he,a as de,b as xe,c as d}from"./dropdown-menu-B6SE2GuO.js";import{u as me,a as je,b as pe}from"./doctor-family-controller-DpQcl4lR.js";import{E as ue,a as ge}from"./eye-quthMXAv.js";import{C as Ce}from"./check-BMh_iTMB.js";import{X as Ne}from"./index-fdDP8kav.js";import{T as De}from"./trash-2-D3N7ccQE.js";import"./clsx-B-dksMZM.js";import"./index-BvPlwEJa.js";import"./index-DcUGr25C.js";import"./index-BYx5ngvf.js";import"./index-BWVphily.js";import"./index-Bb3g6j3I.js";import"./createLucideIcon-BIXz2lW7.js";import"./chevron-right-66CTOTse.js";import"./index-CqIhzmhs.js";const $e=function(){var D,T,E;const w=B(),[t,A]=c.useState(0),[P,Ee]=c.useState(10),[v,S]=c.useState(""),[N,b]=c.useState(""),[x,m]=c.useState(null),{data:n,isLoading:y,refetch:j}=L({page:t,size:P,sort:["createdAt,desc"],status:N||void 0}),I=s=>{S(s.target.value)},k=s=>{b(s)},M=s=>{w({to:"/home/families/$familyId",params:{familyId:s.toString()}})},p=s=>{A(s)},R=me(),F=je(),G=pe(),q=async s=>{await F.mutateAsync({requestId:s}),j()},H=async s=>{await R.mutateAsync({requestId:s}),j()},X=async()=>{x&&(G.mutateAsync({id:x}),m(null),j())},o=((D=n==null?void 0:n.page)==null?void 0:D.totalPages)||0;return e.jsxs("div",{className:"container mx-auto py-6 space-y-6 bg-white min-h-[80vh] px-4 rounded-xl shadow",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Quản lý gia đình"}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsx(V,{placeholder:"Tìm kiếm gia đình...",value:v,onChange:I,className:"w-full"})}),e.jsxs(J,{value:N,onValueChange:k,children:[e.jsx($,{className:"w-[180px]",children:e.jsx(K,{placeholder:"Trạng thái"})}),e.jsxs(O,{children:[e.jsx(u,{value:"PENDING",children:"PENDING"}),e.jsx(u,{value:"ACCEPTED",children:"ACCEPTED"}),e.jsx(u,{value:"REJECTED",children:"REJECTED"})]})]})]}),y?e.jsx("div",{className:"flex justify-center py-8",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(Q,{children:[e.jsx(_,{children:e.jsxs(g,{children:[e.jsx(l,{children:"ID"}),e.jsx(l,{children:"Gia đình"}),e.jsx(l,{children:"Chủ hộ"}),e.jsx(l,{children:"Liên hệ"}),e.jsx(l,{children:"Trạng thái"}),e.jsx(l,{className:"text-right",children:"Thao tác"})]})}),e.jsx(U,{children:((T=n==null?void 0:n.content)==null?void 0:T.length)===0?e.jsx(g,{children:e.jsx(a,{colSpan:6,className:"text-center py-6",children:"Không có dữ liệu"})}):(E=n==null?void 0:n.content)==null?void 0:E.map(s=>{var r,i,h,f;return e.jsxs(g,{children:[e.jsx(a,{children:s.id}),e.jsx(a,{children:((r=s.family)==null?void 0:r.familyName)||"-"}),e.jsx(a,{children:((h=(i=s.family)==null?void 0:i.owner)==null?void 0:h.fullName)||"-"}),e.jsx(a,{children:((f=s.family)==null?void 0:f.phoneNumber)||"-"}),e.jsx(a,{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.status==="ACCEPTED"?"bg-green-100 text-green-800":s.status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.status})}),e.jsx(a,{className:"text-right",children:e.jsxs(he,{children:[e.jsx(de,{asChild:!0,children:e.jsx(z,{variant:"ghost",size:"icon",children:e.jsx(ue,{className:"h-4 w-4"})})}),e.jsxs(xe,{align:"end",children:[e.jsxs(d,{onClick:()=>M(s.familyId),children:[e.jsx(ge,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Xem chi tiết"})]}),s.status==="PENDING"&&e.jsxs(e.Fragment,{children:[e.jsxs(d,{onClick:()=>q(s.id),children:[e.jsx(Ce,{className:"mr-2 h-4 w-4 text-green-600"}),e.jsx("span",{children:"Chấp nhận"})]}),e.jsxs(d,{onClick:()=>H(s.id),children:[e.jsx(Ne,{className:"mr-2 h-4 w-4 text-red-600"}),e.jsx("span",{children:"Từ chối"})]})]}),(s.status==="ACCEPTED"||s.status==="REJECTED")&&e.jsxs(d,{onClick:()=>m(s.id),children:[e.jsx(De,{className:"mr-2 h-4 w-4 text-red-600"}),e.jsx("span",{children:"Xóa"})]})]})]})})]},s.id)})})]})}),e.jsx(ne,{open:!!x,onOpenChange:s=>!s&&m(null),children:e.jsxs(te,{children:[e.jsxs(ae,{children:[e.jsx(ie,{children:"Xác nhận xóa"}),e.jsx(le,{children:"Bạn có chắc chắn muốn xóa liên kết với gia đình này? Hành động này không thể hoàn tác."})]}),e.jsxs(re,{children:[e.jsx(ce,{children:"Hủy"}),e.jsx(oe,{onClick:X,children:"Xóa"})]})]})}),o>0&&e.jsx(W,{className:"mt-4",children:e.jsxs(Y,{children:[e.jsx(C,{children:e.jsx(Z,{onClick:()=>t>0&&p(t-1),className:t===0?"pointer-events-none opacity-50":""})}),Array.from({length:Math.min(5,o)}).map((s,r)=>{const i=r,h=i===t;return e.jsx(C,{children:e.jsx(ee,{onClick:()=>p(i),isActive:h,children:i+1})},r)}),e.jsx(C,{children:e.jsx(se,{onClick:()=>t<o-1&&p(t+1),className:t>=o-1?"pointer-events-none opacity-50":""})})]})})]})]})};export{$e as component};
