import{r as u,n as D,o as q,p as V,R as B,j as e,q as v,s as E,L as H,t as f}from"./index-BW1v2Y3o.js";import{B as i}from"./index-lZj-UG3P.js";import{C as K,b as P,c as Q,d as R,e as A}from"./card-Bb8dNGOw.js";import{I as c}from"./input-B9pFp4AM.js";import{S as G}from"./separator-DARbAqyQ.js";import{D as W,b as Y,c as z,d as I,f as O,g as X}from"./dialog-CtifNpLo.js";import{u as $,s as J,L as h}from"./label-C5VtnZRZ.js";import{z as m}from"./index-B3p3PcZP.js";import{P as y}from"./plus-Brih1OWA.js";import{S as U}from"./search-CqHQ4pyN.js";import{L as b}from"./loader-circle-hO0Wh3rx.js";import"./clsx-B-dksMZM.js";import"./index-fdDP8kav.js";import"./createLucideIcon-BIXz2lW7.js";import"./index-BvPlwEJa.js";import"./index-BYx5ngvf.js";const Z=m.object({familyName:m.string().min(3,{message:"Tên gia đình phải có ít nhất 3 ký tự."}).max(255,{message:"Tên gia đình không được vượt quá 255 ký tự."}),address:m.string().max(500,{message:"Địa chỉ không được vượt quá 500 ký tự."}),phoneNumber:m.string().regex(/^(\+84|0)[3|5|7|8|9][0-9]{8}$/,{message:"Số điện thoại không hợp lệ. Vui lòng nhập số điện thoại Việt Nam hợp lệ."}),email:m.string().email({message:"Email không hợp lệ."}).max(100,{message:"Email không được vượt quá 100 ký tự."})}),_=()=>{const[l,w]=u.useState(""),[k,d]=u.useState(!1),{data:r,isLoading:C,isError:L}=D(),x=q(),{mutate:F,isPending:a}=V({mutation:{onSuccess:()=>{x.invalidateQueries({queryKey:v()}),f.success("Thành công",{description:"Gia đình đã được tạo thành công"}),d(!1),g()},onError:s=>{f.error("Lỗi",{description:s.message||"Không thể tạo gia đình. Vui lòng thử lại."})}}}),{register:o,handleSubmit:S,reset:g,formState:{errors:t,isValid:T}}=$({resolver:J(Z),mode:"onChange"}),M=async s=>{F({data:s})},p=B.useMemo(()=>r?(console.log(r),r==null?void 0:r.filter(s=>{var n;return(n=s.familyName)==null?void 0:n.toLowerCase().includes(l.toLowerCase())})):[],[r,l]);return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx("div",{className:"flex-grow",children:e.jsx("div",{className:"container py-6",children:e.jsxs("div",{className:"flex flex-col space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gia đình"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Quản lý và theo dõi thông tin gia đình của bạn"})]}),e.jsxs(i,{onClick:()=>d(!0),children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Tạo gia đình mới"]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(U,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(c,{placeholder:"Tìm kiếm gia đình...",className:"pl-8 bg-white",value:l,onChange:s=>w(s.target.value)})]})}),C?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(b,{className:"h-12 w-12 animate-spin text-health-blue mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Đang tải dữ liệu gia đình..."})]}):L?e.jsxs("div",{className:"flex flex-col items-center justify-center bg-red-50 p-6 rounded-lg",children:[e.jsx("p",{className:"text-red-600 font-medium",children:"Đã xảy ra lỗi khi tải dữ liệu"}),e.jsx(i,{variant:"outline",className:"mt-4",onClick:()=>x.invalidateQueries({queryKey:v()}),children:"Thử lại"})]}):p.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center bg-gray-50 p-10 rounded-lg",children:l?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-600 mb-2",children:"Không tìm thấy gia đình nào phù hợp"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Hãy thử tìm kiếm với từ khóa khác"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-600 mb-2",children:"Bạn chưa có gia đình nào"}),e.jsxs(i,{onClick:()=>d(!0),className:"mt-4 ",children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Tạo gia đình mới"]})]})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:p.map(s=>{var n,j,N;return e.jsxs(K,{className:"bg-white border border-gray-200 py-2 gap-y-2 rounded-lg shadow-sm hover:shadow-md transition-all overflow-hidden",children:[e.jsxs("div",{className:"bg-health-blue/10 px-6 py-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(P,{className:"text-xl text-health-blue font-semibold truncate",children:s.familyName}),e.jsx("div",{className:"bg-green-100 text-green-700 text-xs font-medium px-2.5 py-1 rounded-full",children:"Active"})]}),e.jsxs(Q,{className:"mt-1 text-sm text-gray-500",children:["Cập nhật:"," ",E(s.updatedAt||s.createdAt).format("DD/MM/YYYY")]})]}),e.jsxs(R,{className:"",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-health-blue/20 rounded-full flex items-center justify-center mr-3",children:e.jsx("span",{className:"text-health-blue font-bold",children:((j=(n=s.owner)==null?void 0:n.fullName)==null?void 0:j.charAt(0))||"?"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:"Chủ hộ"}),e.jsx("div",{className:"text-sm text-gray-700",children:((N=s.owner)==null?void 0:N.fullName)||"Chưa có thông tin"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-md p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Thành viên"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-lg font-semibold",children:5}),e.jsx("span",{className:"text-xs text-gray-500 ml-1",children:"người"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-md p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Lịch hẹn"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500 mr-1.5"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"Đang hoạt động"})]})]})]}),e.jsx(G,{className:"my-3"}),e.jsxs("div",{className:"space-y-2.5",children:[s.address&&e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 mt-0.5 mr-2 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),e.jsx("span",{className:"text-sm text-gray-600 leading-tight",children:s.address})]}),s.phoneNumber&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 mr-2 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),e.jsx("span",{className:"text-sm text-gray-600",children:s.phoneNumber})]}),s.email&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 mr-2 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),e.jsx("span",{className:"text-sm text-gray-600 truncate",children:s.email})]})]})]}),e.jsx(A,{className:"px-5 py-1  border-t border-gray-100",children:e.jsx(i,{variant:"default",className:"w-full  text-white",asChild:!0,children:e.jsx(H,{to:"/home/families/"+s.id,children:e.jsxs("span",{className:"flex items-center justify-center",children:["Xem chi tiết",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})})})})]},s.id)})})]})})}),e.jsx(W,{open:k,onOpenChange:s=>{!s&&!a&&(d(!1),g())},children:e.jsxs(Y,{className:"sm:max-w-xl",children:[e.jsx(z,{children:e.jsx(I,{children:"Tạo gia đình mới"})}),e.jsxs("form",{onSubmit:S(M),children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(h,{htmlFor:"familyName",className:"text-right",children:["Tên gia đình"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(c,{id:"familyName",...o("familyName"),className:"col-span-3",disabled:a,placeholder:"Nhập tên gia đình"}),t.familyName&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.familyName.message})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(h,{htmlFor:"address",className:"text-right",children:["Địa chỉ"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(c,{id:"address",...o("address"),disabled:a,placeholder:"Nhập địa chỉ"}),t.address&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.address.message})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(h,{htmlFor:"phoneNumber",className:"text-right",children:["Số điện thoại"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(c,{id:"phoneNumber",...o("phoneNumber"),disabled:a,placeholder:"VD: 0901234567"}),t.phoneNumber&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.phoneNumber.message})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(h,{htmlFor:"email",className:"text-right",children:["Email"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(c,{id:"email",type:"email",...o("email"),disabled:a,placeholder:"example@email.com"}),t.email&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.email.message})]})]})]}),e.jsxs(O,{children:[e.jsx(X,{asChild:!0,children:e.jsx(i,{type:"button",variant:"outline",disabled:a,children:"Hủy"})}),e.jsx(i,{type:"submit",disabled:a||!T,children:a?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"mr-2 h-4 w-4 animate-spin"}),"Đang tạo..."]}):"Tạo gia đình"})]})]})]})})]})},je=function(){return e.jsx(_,{})};export{je as component};
